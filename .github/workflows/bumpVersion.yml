name: "Bump version protected+main"

on:
    push:
        branches:
            - 'protected'
            - 'main'

jobs:
    bump_version:
        runs-on: ubuntu-latest
        timeout-minutes: 5
        if: ${{ github.actor != 'GHA-Bot' && contains(github.event.commits[0].message, '[Skip CI]') == false }}
        steps:
            - name: Checkout branch
              uses: actions/checkout@v3

            - name: Read Versions Before Bump
              run: cat config/version/mobile.properties

            - name: Bump Version
              run: bash .github/scripts/bumpVersion.sh

            - name: Read Versions After Bump
              run: cat config/version/mobile.properties

            - name: Commit and Push to Protected Branch
              uses: fabriziocacicia/commit-and-push-to-protected-branch-action@v0.1.0
              with:
                  git_user_name: "GHA-Bot"
                  git_user_email: "gha-bot@noreply.github.com"
                  commit_message: "Bump versionCode [Skip CI]"
              env:
                  GH_TOKEN: ${{ github.token }}

#            - name: Update Gradle props
#              run: |
#                  git config --global user.name 'GHA-Bot'
#                  git config --global user.email 'gha-bot@noreply.github.com'
#
#            - name: Commit Updated version
#              run: |
#                  git add config/version/mobile.properties
#                  git commit -m "Bump versionCode [Skip CI]"
#
#            - name: Push commit
#              run: |
#                  git push
